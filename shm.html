<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>تقديم للفريق الإعلامي - مدرسة</title>
  <style>
    :root{--bg:#f7fafc;--card:#fff;--accent:#0b63d6;--muted:#6b7280}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans Arabic',"Helvetica Neue",Arial;padding:20px;background:var(--bg);color:#111}
    .container{max-width:820px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px}
    h1{margin:6px 0;font-size:20px}
    p.lead{color:var(--muted);margin:0 0 18px}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(11,99,214,0.06);margin-bottom:12px}
    label{display:block;margin:8px 0 6px;font-weight:600}
    input[type=text],input[type=url],select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e5e7eb;font-size:14px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
    .secondary{background:#fff;color:var(--accent);border:1px solid #dbeafe}
    .muted{color:var(--muted);font-size:13px}
    footer{font-size:13px;color:var(--muted);margin-top:10px}
    @media(max-width:720px){.row{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>نموذج تقديم — الفريق الإعلامي المدرسي</h1>
        <p class="lead">ارفع مقطعك (دقيقتان) بصيغة رابط مشاركة من Google Drive أو أرسله لواتساب المدرسة.</p>
      </div>
    </header>

    <div class="card">
      <form id="applyForm">
        <div class="row">
          <div>
            <label>الاسم الكامل</label>
            <input type="text" id="name" placeholder="اسم الطالب" required>
          </div>
          <div>
            <label>الصف/الفصل</label>
            <input type="text" id="grade" placeholder="مثال: الأول متوسط - 2أ" required>
          </div>
        </div>

        <label>نوع الموهبة</label>
        <select id="talent">
          <option value="تقديم">تقديم</option>
          <option value="تحرير/كتابة">تحرير/كتابة</option>
          <option value="تصوير/مونتاج">تصوير/مونتاج</option>
          <option value="مراسل ميداني">مراسل ميداني</option>
          <option value="آخر">آخر</option>
        </select>

        <label>رابط المقطع (Google Drive - مشاركة "أي شخص لديه الرابط")</label>
        <input type="url" id="videoLink" placeholder="https://drive.google.com/...?usp=sharing" required>
        <p class="muted">تذكير: يجب أن يجعل الطالب رابط المقطع "Anyone with the link can view" قبل الإرسال.</p>

        <label>نبذة قصيرة (لماذا تريد الانضمام؟ 1-2 سطر)</label>
        <textarea id="bio" rows="3" placeholder="أكتب هنا" required></textarea>

        <div style="margin-top:10px">
          <label>اختيار طريقة الإرسال النهائية</label>
          <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
            <button type="button" id="sendToGoogleForm">إرسال إلى استمارة المدرسة (مخزّن)</button>
            <button type="button" id="sendToEmail" class="secondary">إرسال عبر بريد المدرسة</button>
            <button type="button" id="sendToWhatsApp">إرسال عبر واتساب المدرسة</button>
          </div>
        </div>

        <div class="actions">
          <button type="button" id="preview">معاينة نص الإرسال</button>
          <button type="reset" class="secondary">مسح الحقول</button>
        </div>

      </form>
    </div>

    <div class="card" id="previewCard" style="display:none">
      <h3>معاينة الرسالة</h3>
      <pre id="previewText" style="white-space:pre-wrap"></pre>
      <div style="margin-top:10px">
        <button id="copyBtn">نسخ النص</button>
      </div>
    </div>

    <footer>
      <strong>إرشادات للإدارة / للمشرف:</strong>
      <ul>
        <li>1) يرفع الطالب الفيديو على Google Drive ويجعل المشاركة "أي شخص لديه الرابط" ثم يلصق الرابط هنا.</li>
        <li>2) لاستلام الردود تلقائيًا في جدول: أنشئ Google Form واملأ حقل الرابط والاسم والصف، ثم انسخ رابط الإرسال (action) إلى القسم المعلّق داخل ملف الـHTML أو استخدم Google Forms مباشرة.</li>
        <li>3) ضع رقم واتساب المدرسة بصيغة دولية داخل المتغير SCHOOL_WHATSAPP_NUMBER في الشيفرة (مثال: 9665XXXXXXXX).</li>
        <li>4) يمكنك رفع هذا الملف على أي استضافة ثابتة: GitHub Pages، أو سيرفر المدرسة. (لم يعد يُنصح باستضافة HTML مباشرة عبر Google Drive).</li>
      </ul>
    </footer>
  </div>

  <script>
    // === إعدادات يجب على المشرف تعديلها قبل النشر ===
    const CONFIG = {
      // إذا أنشأتم Google Form وترغبون أن تُحفظ الردود تلقائيًا في جدول:
      // ضعوا هنا رابط action الخاص بالـ form (مثال placeholder). اتركوه فارغاً إذا لم تستخدموا Google Form.
      GOOGLE_FORM_ACTION: "", // مثال: "https://docs.google.com/forms/d/e/FORM_ID/formResponse"

      // إذا استخدمتم Google Form، ضعوا أسماء الحقول (entry.XXXX) المناسبة هنا.
      // أمثلة: {name: 'entry.123456', grade: 'entry.234567', talent: 'entry.345678', link: 'entry.456789', bio: 'entry.567890'}
      GOOGLE_FORM_FIELDS: {
        name: '', grade: '', talent: '', link: '', bio: ''
      },

      // بريد المدرسة لاستلام نسخة (ضعوه إن أردتم استخدام زر البريد)
      SCHOOL_EMAIL: 'school@example.com',

      // رقم واتساب المدرسة بصيغة دولية (بدون +) مثال السعودية: 9665XXXXXXXX
      SCHOOL_WHATSAPP_NUMBER: '9665XXXXXXXX'
    };
    // ==================================================

    const el = id => document.getElementById(id);
    function collect() {
      return {
        name: el('name').value.trim(),
        grade: el('grade').value.trim(),
        talent: el('talent').value,
        link: el('videoLink').value.trim(),
        bio: el('bio').value.trim()
      }
    }

    function validate(data){
      if(!data.name||!data.grade||!data.link||!data.bio) return false;
      // basic URL check
      try{ new URL(data.link); }catch(e){return false}
      return true;
    }

    el('preview').addEventListener('click', ()=>{
      const d = collect();
      if(!validate(d)){ alert('الرجاء ملء جميع الحقول بشكل صحيح'); return }
      const txt = `اسم الطالب: ${d.name}\nالصف: ${d.grade}\nنوع الموهبة: ${d.talent}\nرابط المقطع: ${d.link}\nنبذة: ${d.bio}`
      el('previewText').textContent = txt;
      el('previewCard').style.display = 'block';
    });

    el('copyBtn').addEventListener('click', ()=>{
      navigator.clipboard.writeText(el('previewText').textContent).then(()=>alert('نُسخ النص'));
    });

    // إرسال إلى Google Form (يتطلب تعبئة CONFIG.GOOGLE_FORM_ACTION وFIELD names)
    el('sendToGoogleForm').addEventListener('click', async ()=>{
      const data = collect(); if(!validate(data)){ alert('الرجاء ملء جميع الحقول بشكل صحيح'); return }
      if(!CONFIG.GOOGLE_FORM_ACTION){ alert('لم يتم إعداد اتصال Google Form. يمكنك إعداد Google Form ثم نسخ رابط الـ formResponse هنا في إعدادات الملف.'); return }
      const formData = new FormData();
      const f = CONFIG.GOOGLE_FORM_FIELDS;
      formData.append(f.name, data.name);
      formData.append(f.grade, data.grade);
      formData.append(f.talent, data.talent);
      formData.append(f.link, data.link);
      formData.append(f.bio, data.bio);
      try{
        await fetch(CONFIG.GOOGLE_FORM_ACTION, { method: 'POST', mode: 'no-cors', body: formData });
        alert('تم الإرسال إلى استمارة المدرسة (إن لم تظهر رسالة خطأ فذلك طبيعي بسبب قيود Google Forms).');
      }catch(e){ alert('فشل الإرسال: '+e.message) }
    });

    // إرسال عبر بريد المدرسة (يفتح عميل البريد المثبت)
    el('sendToEmail').addEventListener('click', ()=>{
      const d = collect(); if(!validate(d)){ alert('الرجاء ملء جميع الحقول بشكل صحيح'); return }
      const subject = encodeURIComponent('تقديم - الفريق الإعلامي: '+d.name);
      const body = encodeURIComponent(`اسم الطالب: ${d.name}\nالصف: ${d.grade}\nنوع الموهبة: ${d.talent}\nرابط المقطع: ${d.link}\nنبذة: ${d.bio}`);
      const mail = `mailto:${CONFIG.SCHOOL_EMAIL}?subject=${subject}&body=${body}`;
      window.location.href = mail;
    });

    // إرسال عبر واتساب المدرسة (يفتح تطبيق واتساب أو نسخة الويب)
    el('sendToWhatsApp').addEventListener('click', ()=>{
      const d = collect(); if(!validate(d)){ alert('الرجاء ملء جميع الحقول بشكل صحيح'); return }
      const phone = CONFIG.SCHOOL_WHATSAPP_NUMBER.replace(/\D/g,'');
      if(!phone){ alert('لم يُعدّ رقم واتساب المدرسة في إعدادات الملف. الرجاء تعديل المتغير SCHOOL_WHATSAPP_NUMBER.'); return }
      const text = `تقديم للفريق الإعلامي%0Aاسم: ${encodeURIComponent(d.name)}%0Aالصف: ${encodeURIComponent(d.grade)}%0Aنوع الموهبة: ${encodeURIComponent(d.talent)}%0Aرابط المقطع: ${encodeURIComponent(d.link)}%0Aنبذة: ${encodeURIComponent(d.bio)}`;
      const url = `https://wa.me/${phone}?text=${text}`;
      window.open(url,'_blank');
    });

  </script>
</body>
</html>

